<head>
    <!-- Anime Page CSS -->
    <link rel="stylesheet" type="text/css" href="{{ url_for('static', filename='anime.css') }}">
</head>

{% extends "base.html" %}

{% block content %}
<div class="row">&nbsp;</div>
<div class="container">

    <div class="row">
        <!--sidebar-->
        <div class="col-md-3">
            <img class="img-responsive" src="{{ anime.image_file }}" style="padding-bottom: 15px" width="100%">
            <h6 style="padding-top: 10px">Alternative Titles</h6>
            <p style="text-align:left; font-size:12px">
                <b>English:</b> {{ anime.title }}
                <br>
                <b>Japanese:</b> {{ anime.title_japanese }}
            </p>
            <hr>
            <h6 style="padding-top: 10px">Information</h6>
            <table style="width:100%; font-size:12px">
                <tr>
                    <td>Score</td>
                    <td class="align-right"><b>⭐{{ anime.score }}/10</b></td>
                </tr>
                <tr>
                    <td>Type</td>
                    <td class="align-right"><b>{{ anime.type }}</b></td>
                </tr>
                <tr>
                    <td>Episodes</td>
                    <td class="align-right">
                        <b>
                        {% if anime.episodes==0 %}
                            N/A
                        {% else %}
                            {{ anime.episodes }}
                        {% endif %}
                        </b>
                    </td>
                </tr>
                <tr>
                    <td>Status</td>
                    <td class="align-right"><b>{{ anime.status }}</b></td>
                </tr>
                <tr>
                    <td>Rating</td>
                    <td class="align-right"><b>{{ anime.rating }}</b></td>
                </tr>
                <tr>
                    <td>Premiered</td>
                    <td class="align-right"><b>{{ anime.premiered }}</b></td>
                </tr>
                <tr>
                    <td>Broadcast</td>
                    <td class="align-right"><b>{{ anime.broadcast }}</b></td>
                </tr>

                <tr>
                    <td>Genres</td>
                    <td class="align-right">
                        {% set genres = anime.genres.strip('[]').replace("'", "").strip(',') %}
                        <b>{{ genres }}</b>
                    </td>
                </tr>
            </table>
            <hr>
        </div>
        <!--content-->
        <div class="col-md-9">
            <h4 style="padding-bottom: 20px">{{ anime.title }}</h4>
            {% set genresList = genres.split(", ") %}
            {% for genre in genresList %}
            <button type="button" class="btn btn-dark btn-sm" style="font-size: 0.8em">{{ genre }}</button>
            {% endfor %}
            <hr>

            {% if current_user.is_authenticated %}
            <div class="row">
                <div class="col-md-2"></div>
                <div class="col-md-10 text-right">
                    <!-- STATUS - Dropdown button -->
                    <div class="btn-group dropdown">
                        <button type="button" class="btn btn-info btn-sm dropdown-toggle" data-toggle="dropdown" aria-haspopup="true" aria-expanded="false">
                            Displayed Status
                        </button>
                        <div class="dropdown-menu">
                            <a class="dropdown-item" href="#">Watching</a>
                            <a class="dropdown-item active" href="#">Completed</a>
                            <a class="dropdown-item" href="#">On Hold</a>
                            <a class="dropdown-item" href="#">Dropped</a>
                            <a class="dropdown-item" href="#">Plan to Watch</a>
                        </div>
                    </div>
                    <!-- USER RATING - Dropdown button -->
                    <div class="btn-group dropdown">
                        <button type="button" class="btn btn-warning btn-sm dropdown-toggle" data-toggle="dropdown" aria-haspopup="true" aria-expanded="false">
                            ⭐ Rating
                        </button>
                        <div class="dropdown-menu">
                            <a class="dropdown-item" href="#">10</a>
                            <a class="dropdown-item" href="#">9</a>
                            <a class="dropdown-item active" href="#">8</a>
                            <a class="dropdown-item" href="#">7</a>
                            <a class="dropdown-item" href="#">6</a>
                            <a class="dropdown-item" href="#">5</a>
                            <a class="dropdown-item" href="#">4</a>
                            <a class="dropdown-item" href="#">3</a>
                            <a class="dropdown-item" href="#">2</a>
                            <a class="dropdown-item" href="#">1</a>
                        </div>
                    </div>
                    <button type="submit" class="btn btn-danger"><i class="fa fa-heart"> Favorite</i></button>
                </div>
            </div>

            <h6 style="padding-left:25px">Episode</h6>
            {% if user_anime %}
                {% set userEpisode=user_anime.episodes_watched %}
            {% else %}
                {% set userEpisode=0 %}
            {% endif %}

            <div class="row">
                <div class="col-md-2">
                    <div class="input-group input-group-sm">
                          <span class="input-group-btn">
                              <button type="button" class="btn btn-default btn-number" disabled="disabled" data-type="minus" data-field="quant[1]">
                                  <i class="fa fa-minus" aria-hidden="true"></i>
                              </button>
                          </span>
                          <input type="text" name="quant[1]" class="form-control input-number" value="{{ userEpisode }}" min="0" max="{{ anime.episodes }}">
                          <span class="input-group-btn">
                              <button type="button" class="btn btn-default btn-number" data-type="plus" data-field="quant[1]">
                                  <i class="fa fa-plus" aria-hidden="true"></i>
                              </button>
                          </span>
                    </div>
                </div>
                <div class="col-md-10">
                    <h6 style="text-align:center">Completion Status</h6>
                    <div class="progress bg-secondary">
                        {% set barWidth= userEpisode/anime.episodes*100 %}
                        <div class="progress-bar bg-success" role="progressbar" style="width: {{ barWidth }}%" >&nbsp; {{ userEpisode }} / {{ anime.episodes }} episodes</div>
                    </div>
                </div>
            </div>
            {% endif %}


            <h5 style="padding-top: 25px">Synopsis</h5>
            <p>{{ anime.synopsis }}</p>
            <hr>

            {% if current_user.is_authenticated %}
            <!-- Comments Form -->
            <div class="card my-4">
                <h6 class="card-header">Leave a Review</h6>
                <div class="card-body">
                    <form>
                        <div class="form-group">
                          <textarea class="form-control" rows="3"></textarea>
                        </div>
                        <button type="submit" class="btn btn-primary">Submit</button>
                    </form>
                </div>
            </div>
            <hr>
            {% endif %}

            <h5 style="padding-top: 15px;" class="pb-4">User Reviews</h5>

            <!-- User Reviews -->
            {% for review in reviews %}
                {% include '_animeReview.html' %}
            <hr>
            {% endfor %}
        </div>
    </div>

</div>

{% endblock %}